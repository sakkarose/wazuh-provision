<agent_config>
<!-- Linux only section -->

    <localfile>
        <log_format>syslog</log_format>
        <location>/var/log/syslog</location>
    </localfile>

    <localfile>
        <log_format>json</log_format>
        <location>/opt/zeek/logs/current/*.log</location>
    </localfile>

    <localfile>
        <log_format>json</log_format>
        <location>/var/log/tetragon/tetragon.log</location>
        <out_format>$(timestamp) $(hostname) tetragon-events: $(log)</out_format>
    </localfile>

    <!-- Add whodata="yes" to every directories entry -->
    <syscheck>
        <directories whodata="yes" check_all="yes" realtime="yes" report_changes="yes">/home/*</directories>
        <directories whodata="yes" realtime="yes" report_changes="yes">/etc/apparmor.d</directories>

        <whodata>
            <provider>ebpf</provider>
            <queue_size>50000</queue_size>
        </whodata>
    </syscheck>

    <sca>
        <policies>
            <policy>/var/ossec/etc/custom-sca-files/autocolor_check.yml</policy>
            <policy>/var/ossec/etc/custom-sca-files/sca_docker.yml</policy>
        </policies>
    </sca>

    <wodle name="docker-listener">
        <interval>10m</interval>
        <attempts>5</attempts>
        <run_on_start>no</run_on_start>
        <disabled>no</disabled>
    </wodle>

<!-- Sharable -->

    <!-- System inventory -->
    <wodle name="syscollector">
        <disabled>no</disabled>
        <interval>1h</interval>
        <scan_on_start>yes</scan_on_start>
        <hardware>yes</hardware>
        <os>yes</os>
        <network>yes</network>
        <packages>yes</packages>
        <ports all="no">yes</ports>
        <processes>yes</processes>

    <!-- Database synchronization settings -->
        <synchronization>
            <max_eps>10</max_eps>
        </synchronization>
    </wodle>

</agent_config>