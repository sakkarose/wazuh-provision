<group name="hyper-v,windows,">

  <rule id="100116" level="0">
    <if_sid>60009,60010</if_sid>
    <field name="win.system.providerName" type="pcre2">^Microsoft-Windows-Hyper-V</field>
    <description>Base rule for Hyper-V events.</description>
  </rule>

  <rule id="100117" level="3">
    <if_sid>100116</if_sid>
    <field name="win.system.eventID" type="pcre2">^12140$|^12170$|^12180$|^12597$|^12598$|^12670$|^13002$|^13003$|^18500$|^18502$|^18504$|^18510$|^18516$|^18596$|^26000$|^26004$|^26012$|^26016$|^26074$</field>
    <description>Hyper-V: $(win.system.message).</description>
  </rule>

  <rule id="100118" level="5">
    <if_sid>60011</if_sid>
    <field name="win.system.providerName" type="pcre2">^Microsoft-Windows-Hyper-V</field>
    <description>Hyper-V: $(win.system.message).</description>
  </rule>

  <rule id="100119" level="10">
    <if_sid>60012</if_sid>
    <field name="win.system.providerName" type="pcre2">^Microsoft-Windows-Hyper-V</field>
    <description>Hyper-V: $(win.system.message).</description>
  </rule>
  
  <rule id="100120" level="0">
    <location>command_hyper-v_metrics</location>
    <decoded_as>json</decoded_as>
    <description>Base rule for Hyper-V metrics.</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100121" level="3">
    <if_sid>100120</if_sid>
    <field name="hyper-v.metric">VM state</field>
    <description>Hyper-V metrics: State for the VM "$(hyper-v.vm_name)" is "$(hyper-v.state)".</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100122" level="3">
    <if_sid>100120</if_sid>
    <field name="hyper-v.metric">Disk usage</field>
    <description>Hyper-V metrics: $(hyper-v.used_percent)% of drive "$(hyper-v.drive)" used on "$(hyper-v.host)".</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100123" level="3">
    <if_sid>100120</if_sid>
    <field name="hyper-v.metric">Memory usage</field>
    <description>Hyper-V metrics: $(hyper-v.used_percent)% of memory used on "$(hyper-v.host)".</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100124" level="3">
    <if_sid>100120</if_sid>
    <field name="hyper-v.metric">CPU usage</field>
    <description>Hyper-V metrics: $(hyper-v.used_percent)% of CPU used on "$(hyper-v.host)".</description>
    <options>no_full_log</options>
  </rule>

</group>