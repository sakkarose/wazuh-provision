<group name="WinCounter,">

    <rule id="100321" level="0">
      <decoded_as>json</decoded_as>
      <match>^{"winCounter":</match>
      <description>Windows Performance Counter: $(winCounter.Path)</description>
    </rule>
    
    <rule id="100322" level="3">
      <if_sid>100321</if_sid>
      <field name="winCounter.Path">memory\\available mbytes</field>
      <description>Windows Counter: Available Memory</description>
      <group>MEMUsage,</group>
    </rule>

    <rule id="100323" level="5">
      <if_sid>100322</if_sid>
      <field name="winCounter.CookedValue" type="pcre2">^[5-9]\d\d$</field>
      <description>Windows Counter: Available Memory less than 1GB</description>
      <group>MEMUsage,</group>
    </rule>
    
    <rule id="100324" level="7">
      <if_sid>100322</if_sid>
      <field name="winCounter.CookedValue" type="pcre2">^[1-4]\d\d$</field>
      <description>Windows Counter: Available Memory less than 500GB</description>
      <group>MEMUsage,</group>
    </rule>

    <rule id="100325" level="3">
      <if_sid>100321</if_sid>
      <field name="winCounter.Path">free megabytes</field>
      <description>Windows Counter: Disk Space Free</description>
      <group>DiskFree,</group>
    </rule>

    <rule id="100326" level="3">
      <if_sid>100321</if_sid>
      <field name="winCounter.Path">bytes received/sec</field>
      <description>Windows Counter: Network Traffic In</description>
      <group>NetworkTrafficIn,</group>
    </rule>

    <rule id="100327" level="3">
      <if_sid>100321</if_sid>
      <field name="winCounter.Path">bytes sent/sec</field>
      <description>Windows Counter: Network Traffic Out</description>
      <group>NetworkTrafficOut,</group>
    </rule>
    
    <rule id="100328" level="3">
      <if_sid>100321</if_sid>
      <field name="winCounter.Path">processor\S+ processor time</field>
      <description>Windows Counter: CPU Usage</description>
      <group>CPUUsage,</group>
    </rule>

    <rule id="100329" level="5">
      <if_sid>100328</if_sid>
      <field name="winCounter.CookedValue">^8\d.\d+$</field>
      <description>Windows Counter: CPU Usage above 80%</description>
      <group>CPUUsage,</group>
    </rule>
    
    <rule id="100330" level="7">
      <if_sid>100328</if_sid>
      <field name="winCounter.CookedValue">^9\d.\d+$</field>
      <description>Windows Counter CPU Usage above 90%</description>
      <group>CPUUsage,</group>
    </rule>

</group>